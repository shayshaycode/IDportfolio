"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6895],{48953:e=>{e.exports=function(e){const t=e.displayTitle,s=e._heroImage?._isEnabled?e._heroImage.title:null;return t||s}},24539:(e,t)=>{t.GROUP_CATEGORY_CHANGED="GROUP_CATEGORY_CHANGED",t.CATEGORY_CHANGED="CATEGORY_CHANGED",t.RESET_CATEGORIES="RESET_CATEGORIES",t.groupCategoryChanged=(e,s)=>({type:t.GROUP_CATEGORY_CHANGED,payload:{groupId:e,categoryId:s}}),t.categoryChanged=e=>({type:t.CATEGORY_CHANGED,payload:{categoryId:e}}),t.resetCategories=()=>({type:t.RESET_CATEGORIES})},7692:(e,t,s)=>{const r=s(16842),n=s(60216),i=s(27378),o=s(95685),a=r({displayName:"PlaylistCategoryButton",propTypes:{category:n.object.isRequired,onClick:n.func.isRequired,isSelected:n.bool},onClick(e){e.preventDefault(),e.currentTarget.blur(),this.props.onClick(this.props.category._id)},render(){return i.createElement("button",{className:o("ev-category-button ev-button ev-primary",{"ev-is-selected":this.props.isSelected}),onClick:this.onClick},this.props.category.name)}});e.exports=a},91262:(e,t,s)=>{const r=s(37213),n=s(16842),i=s(60216),o=s(27378),a=n({displayName:"PlaylistGroupSelect",propTypes:{allText:i.string.isRequired,group:i.shape({_id:i.string.isRequired,name:i.string.isRequired,categories:i.object.isRequired,selectedCategory:i.string}).isRequired,onChange:i.func.isRequired},render(){const{allText:e,group:t,onChange:s}=this.props;return o.createElement("div",{className:"ev-playlist-group-select"},o.createElement("label",null,t.name,o.createElement("select",{id:t._id,value:t.selectedCategory,onChange:({target:e})=>s(t._id,e.value)},o.createElement("option",{value:"all"},e),r(t.categories,(({_id:e,name:t})=>o.createElement("option",{value:e,key:e},t))))))}});e.exports=a},79402:(e,t,s)=>{const r=s(20520),n=s(61868),i=s(86330),o=s(88423),a=s(98978),l=s(37213),u=s(30485),c=s(16842),d=s(60216),p=s(27378),{connect:m}=s(13844),h=s(95685),{setAriaLive:g}=s(83197),y=s(51534),C=s(55952),v=s(89354),_=s(52604),E=s(66039),b=s(3327),{categoryChanged:I,groupCategoryChanged:R,resetCategories:M}=s(24539),T=s(65296),N=s(91262),S=s(67044),A=s(7692),f=s(84572),k="all",P=c({displayName:"PlaylistMenu",propTypes:{course:d.object.isRequired,menu:d.object.isRequired,device:d.object.isRequired,theme:d.object.isRequired,items:d.object.isRequired,location:d.object.isRequired,categories:d.object.isRequired,groups:d.object.isRequired,selectedCategory:d.string.isRequired,categoryChanged:d.func.isRequired,groupCategoryChanged:d.func.isRequired,resetCategories:d.func.isRequired,setAriaLive:d.func.isRequired,hasActionBar:d.bool.isRequired,isShowingHiddenContent:d.bool,history:d.object.isRequired,classList:d.array},getInitialState:()=>({_selectedItemId:null}),componentDidMount(){this.announceMenuAriaLabel()},componentDidUpdate({menu:e}){e._id!==this.props.menu._id&&this.announceMenuAriaLabel()},announceMenuAriaLabel(){this.props.menu.ariaLabel&&this.props.setAriaLive({message:this.props.menu.ariaLabel,delay:200})},getSelectedCategoriesMap(){const{props:e}=this,t=r(e.groups,((e,t)=>(t.selectedCategory!==k&&(e[t.selectedCategory]=!0),e)),{});return e.selectedCategory!==k&&(t[e.selectedCategory]=!0),t},getMenuItems(){const{props:e}=this,t=this.getSelectedCategoriesMap(),s=e.menu._id!==e.course._id?e.menu._id:null,r=n(t),l=i(e.items,(i=>!(i._isHidden&&!e.isShowingHiddenContent||"page"!==i._type||s&&i._parentId!==s||r&&n(o(t,i._categories))!==r)));return a(l,"_contentObjectOrder")},getAvailableMenus(){return i(this.props.items,(e=>"menu"===e._type))},getClassName(){const{classList:e,theme:t}=this.props;return h("ev-playlist-menu ev-menu",e,{"ev-use-menu-header-styles":t._menu._settings._useMenuHeaderStyles,"ev-disable-inner-flex":t._footer._settings._isStickyFooterDisabled})},getIsMenuReady(){const{menu:e,location:t}=this.props;return!(!e._isReady||!t.isLocationReady)},onResetCategories(e){e.preventDefault(),e.currentTarget.blur();const{props:t}=this;t.resetCategories(),t.history.replace(`/menu/${t.course._id}`)},onCategoryChanged(e){this.props.categoryChanged(e)},onGroupCategoryChanged(e,t){this.props.groupCategoryChanged(e,t)},onMenuChanged(e){const{props:t}=this,s=e===k?t.course._id:e;t.history.push(`/menu/${s}`)},onShowItemContent(e){this.setState({_selectedItemId:e})},renderGroupFilters(){return n(this.props.groups)?l(this.props.groups,(e=>p.createElement(N,{key:e._id,group:e,allText:u(this.props.course,"_playlistMenu.allText","All"),onChange:this.onGroupCategoryChanged}))):null},renderMenuSelect(e){if(!e.length)return;const{props:t}=this;return p.createElement(S,{items:e,value:t.menu._id===t.course._id?k:t.menu._id,allText:u(this.props.course,"_playlistMenu.allText","All"),onChange:this.onMenuChanged})},renderFullPlaylistButton(e){if(!e)return;const{props:t}=this;return p.createElement("button",{onClick:this.onResetCategories,className:"ev-category-button ev-button ev-primary"},u(t.course,"_playlistMenu._fullPlaylist"))},renderFilters(){const e=this.renderGroupFilters(),t=this.getAvailableMenus(),s=this.renderMenuSelect(t);if(!e&&!s)return;const r=this.renderFullPlaylistButton(!n(this.props.categories)&&(e||s));return p.createElement("div",{className:"ev-categories-action-bar-items"},e,s,r)},renderCategoryButtons(){return n(this.props.categories)?p.createElement("div",{className:"ev-categories-action-bar-items"},l(this.props.categories,(e=>p.createElement(A,{key:e._id,category:e,isSelected:this.props.selectedCategory===e._id,onClick:this.onCategoryChanged}))),this.renderFullPlaylistButton(!0)):null},renderActionBar(){const e=this.renderFilters(),t=this.renderCategoryButtons();if(e||t)return p.createElement("div",{className:"ev-categories-action-bar ev-action-bar"},p.createElement("div",{className:"ev-action-bar-inner"},e,t))},getShouldShowProgressBars(){const{props:e}=this,t=u(e.theme,"_menu._settings._shouldShowProgressBarsOnMenus","content"),s=u(e.menu,"_playlistMenu._shouldShowProgressBarsOnMenus",!0);return"content"===t?s:"true"===t},renderItems(){const{props:e,state:t}=this,s=this.getMenuItems(),r=u(e.theme,"_menu._settings._durationIcon",null);return l(s,(s=>p.createElement(f,{key:s._id,itemId:s._id,device:e.device,durationIcon:r,shouldShowProgressBarsOnMenus:this.getShouldShowProgressBars(),isContentVisible:t._selectedItemId===s._id,onShowItemContent:this.onShowItemContent})))},renderElements(e){return y("menu",e,{menu:this.props.menu})},renderHeroImage(e){const{_heroImage:t}=this.props.menu._playlistMenu;if(t)return p.createElement(b.Provider,{value:this.props.menu.displayTitle?this.context+1:this.context},p.createElement(E,{title:t.title,body:t.body,graphic:t._graphic,_contentWidth:t._contentWidth,layout:t.layout,floatingGraphic:t._floatingGraphic,parentSelector:".ev-menu-container-inner",contentObjectType:"menu",theme:this.props.theme,isReady:e}))},render(){const{props:e}=this,t=v(),s=this.getIsMenuReady(),r=e.menu.displayTitle||e.menu._playlistMenu._heroImage?.title?this.context+1:this.context;return p.createElement("div",{className:this.getClassName()},p.createElement(_,{backgroundImage:e.menu._playlistMenu._desktopBackgroundImage,mobileBackgroundImage:e.menu._playlistMenu._mobileBackgroundImage}),C(e.menu),p.createElement("main",{className:"ev-menu-container",style:{minHeight:`calc(100vh - ${t})`},tabIndex:"-1"},p.createElement("div",{className:"ev-menu-root"},this.renderElements("root")),p.createElement("div",{className:"ev-menu-container-inner"},this.renderHeroImage(s),p.createElement(T,{menu:e.menu,hasActionBar:this.props.hasActionBar}),p.createElement(b.Provider,{value:r},p.createElement("div",{className:"ev-action-bar-container"},this.renderElements("actionBar")),this.renderActionBar(),p.createElement("div",{className:"ev-menu-items"},p.createElement("div",{className:"ev-menu-items-inner ev-clearfix"},this.renderItems())))),p.createElement("div",{className:"ev-menu-footer"},this.renderElements("footer"))))}});P.contextType=b,e.exports=m((e=>({...e.playlistMenu,items:e.contentObjects})),{setAriaLive:g,categoryChanged:I,groupCategoryChanged:R,resetCategories:M})(P)},65296:(e,t,s)=>{const r=s(16842),n=s(60216),i=s(27378),o=s(81986),a=s(4527),l=s(64689),u=s(95685),c=s(41033),d=s(15835),p=s(3327),m=r({displayName:"PlaylistMenuHeader",propTypes:{menu:n.object.isRequired,hasActionBar:n.bool.isRequired},renderTitle(){if(this.props.menu.displayTitle)return i.createElement(d,{headingElement:`h${this.context}`,displayTitle:this.props.menu.displayTitle,displayTitleSettings:this.props.menu._displayTitleSettings,className:"ev-menu-title ev-header-title",innerClassName:"ev-menu-title-inner ev-header-title-inner"})},renderBody(){if(this.props.menu.body)return i.createElement(c,{className:"ev-menu-body ev-header-body",innerClassName:"ev-menu-body-inner ev-header-body-inner",body:this.props.menu.body})},getStyle(e){const t=e._playlistMenu._backgroundImage;if(!a(t))return l(!0);const{src:s,srcAdvanced:r}=t;return{backgroundImage:`url("${o(s,r,!0)}")`,minHeight:"350px"}},render(){const{menu:e}=this.props;return e.displayTitle||e.body?i.createElement("div",{className:u("ev-menu-header ev-header",{"ev-header-with-action-bar":this.props.hasActionBar}),style:this.getStyle(e)},i.createElement("div",{className:"ev-menu-header-inner ev-header-inner ev-clearfix ev-no-graphic"},i.createElement("div",{className:"ev-menu-header-content ev-header-left"},this.renderTitle(),this.renderBody()))):null}});m.contextType=p,e.exports=m},84572:(e,t,s)=>{const r=s(16842),{bool:n,number:i,object:o,string:a}=s(60216),l=s(27378),u=s(31542),c=s(95685),d=s(48953),p=s(55952),m=s(51534),h=s(15835),g=s(41033),{MenuItemProgress:y,MenuItemHOC:C,MenuItemDuration:v,MenuItemLink:_}=s(85975),E=s(81986),b=s(4527),I=s(46411),R=s(3327),M=r({displayName:"PlaylistMenuItem",propTypes:{item:o.isRequired,device:o.isRequired,durationIcon:a,shouldShowProgressBarsOnMenus:n,isContentVisible:n.isRequired,isVisibleItem:n,pageMenuItemsCount:i,pageMenuItemsCompletedCount:i,completedChildrenAsPercentage:i},getInitialState:()=>({_height:window.innerHeight}),componentDidMount(){this.updateSizes()},UNSAFE_componentWillReceiveProps({device:e}){e!==this.props.device&&this.updateSizes()},updateSizes(){const e=u.findDOMNode(this).offsetWidth;this.setState({_height:e})},onClick(e){const{item:t}=this.props;t._isLocked&&e.preventDefault()},renderTitle(){const e=d(this.props.item);if(e)return l.createElement(h,{id:`${this.props.item._id}-title`,headingElement:`h${this.context}`,displayTitle:e,className:"ev-menu-item-title",innerClassName:"ev-menu-item-title-inner"})},renderBody(){if(this.props.item.description)return l.createElement(g,{id:`${this.props.item._id}-description`,body:this.props.item.description,className:"ev-menu-item-body",innerClassName:"ev-menu-item-body-inner"})},renderDuration(){const{duration:e,durationLabel:t}=this.props.item;if(e)return l.createElement(v,{duration:e,durationIcon:this.props.durationIcon,durationLabel:t})},renderProgress(){const{props:e}=this;if(e?.shouldShowProgressBarsOnMenus)return l.createElement(y,{item:e.item,pageMenuItemsCompletedCount:e.pageMenuItemsCompletedCount,pageMenuItemsCount:e.pageMenuItemsCount,completedChildrenAsPercentage:e.completedChildrenAsPercentage})},renderLink(){const{item:e}=this.props;return l.createElement(_,{id:e._id,isLocked:e._isLocked,isVisited:e._isVisited,linkText:e.linkText,linkIcon:e.linkIcon,isLinkIconRightPosition:e.isLinkIconRightPosition,link:`/${e._type}/${e._id}`})},getStyle(){const e={height:`${this.state._height}px`},t=this.props.item?._playlistMenu?._graphic;return b(t)?(e.backgroundImage=`url("${E(t.src,t.srcAdvanced,!0)}")`,e):e},getItemClass(){return c("ev-menu-item ev-collection-item",`ev-menu-item-${this.props.item._id}`,{"ev-is-visible-item":this.props.isVisibleItem,"ev-is-content-visible":this.props.isContentVisible})},renderElements(e){return m("menuItem",e,{item:this.props.item})},render(){return l.createElement(I,{id:this.props.item._id,name:"menu item",className:this.getItemClass(),style:this.getStyle()},this.renderElements("root"),p(this.props.item,"menuitem"),l.createElement("div",{className:"ev-menu-item-inner ev-collection-item-inner"},l.createElement("div",{className:"ev-collection-item-content"},l.createElement("div",{className:"ev-collection-item-content-inner ev-clearfix"},this.renderTitle(),l.createElement("div",{className:"ev-menu-item-hidden-content"},this.renderBody(),this.renderDuration(),this.renderElements("content"),this.renderProgress(),this.renderLink())))))}});M.contextType=R,e.exports=C(M)},67044:(e,t,s)=>{const r=s(37213),n=s(16842),i=s(60216),o=s(27378),a=n({displayName:"PlaylistMenuSelect",propTypes:{label:i.string,allText:i.string.isRequired,items:i.array.isRequired,onChange:i.func.isRequired,value:i.string.isRequired},getDefaultProps:()=>({label:"Topic"}),render(){return o.createElement("div",{className:"ev-playlist-group-select"},o.createElement("label",null,this.props.label,o.createElement("select",{value:this.props.value,onChange:({target:e})=>this.props.onChange(e.value),id:"ev-playlist-menu-select"},o.createElement("option",{value:"all",key:"all"},this.props.allText),r(this.props.items,(e=>{const t=e._playlistMenu?e._playlistMenu._menuDropdownTitle:null;return o.createElement("option",{key:e._id,value:e._id},t||e.title)})))))}});e.exports=a},6709:(e,t,s)=>{const{registerMenu:r,registerReducer:n}=s(59671),i=s(40886),o=s(79402);n("playlistMenu",i),r("playlistMenu",o,{shouldFilterChildren:!1,shouldRerenderOnMenuChanged:!1})},40886:(e,t,s)=>{const r=s(53792),n=s(1026),i=s(63269),o=s(88423),a=s(9086),{SETUP_APP:l}=s(81661),{CATEGORY_CHANGED:u,GROUP_CATEGORY_CHANGED:c,RESET_CATEGORIES:d}=s(24539),p={selectedCategory:"all",categories:{},groups:{}};e.exports=(e=p,t)=>{switch(t.type){case l:return function(e,{course:t,settings:s}){if("playlistMenu"!==s._menu)return e;const r=n(t._categories,"_id"),l=i(t._categoryGroups).map((e=>({...e,categories:o(r,e._categories),selectedCategory:"all"}))).keyBy("_id").value(),u=i(t._categoryGroups).map((e=>e._categories)).flatten().value(),c=a(r,u);return{...p,groups:l,categories:c}}(e,t.payload);case u:return{...e,selectedCategory:t.payload.categoryId};case c:return{...e,groups:{...e.groups,[t.payload.groupId]:{...e.groups[t.payload.groupId],selectedCategory:t.payload.categoryId}}};case d:return{...e,selectedCategory:"all",groups:r(e.groups,(e=>({...e,selectedCategory:"all"})))};default:return e}}}}]);