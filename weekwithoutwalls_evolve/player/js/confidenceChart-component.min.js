(self.webpackChunk=self.webpackChunk||[]).push([[1983],{43648:(e,t,n)=>{"use strict";var o=n(84994);const r=n(37213),s=n(30485),i=n(86330),a=n(16842),c=n(60216),d=n(27378),{connect:l}=n(13844),p=n(95685),m=n(32382),h=n(67209),u=n(57867),v=n(88153),f=n(17290),{Component:w}=n(84335),_=n(3327),{loadPdfMake:C}=n(99852),g=n(8594),b=d.lazy((()=>Promise.all([n.e(8274),n.e(4547)]).then(n.bind(n,28552)).then((e=>Promise.resolve({default:e.Radar}))))),y=a({displayName:"ConfidenceChart",propTypes:{component:c.object.isRequired,confidenceSliders:c.object,chartItems:c.array,setComponentAsReady:c.func.isRequired,setComponentAsComplete:c.func.isRequired,loadPdfMake:c.func.isRequired,theme:c.object.isRequired,styles:c.object,device:c.object},componentDidMount(){const{component:e,loadPdfMake:t}=this.props;this.props.setComponentAsReady(e._id),e._canDownload&&t()},UNSAFE_componentWillReceiveProps(e){const{component:t,loadPdfMake:n}=this.props;!t._canDownload&&e.component._canDownload&&n()},onVisibilityChange(...e){f(...e,this,this.props.setComponentAsComplete)},onDownloadClicked(){const{downloadTitleText:e,_downloadTitleTextSize:t,_downloadTitleTextAlignment:n,downloadBodyText:r,_downloadBodyTextSize:s,_downloadBodyTextAlignment:i,downloadDateLabel:a,_downloadDateLabelTextSize:c,_downloadDateLabelTextAlignment:d,downloadFileName:l}=this.props.component,p=o(`.ev-chart-${this.props.component._id}`).get(0);if(!p)return;const m=p.toDataURL(),h=[];e&&h.push({text:e,fontSize:t||32,alignment:n||"center",margin:[0,0,0,20]}),r&&h.push({text:r,fontSize:s||18,alignment:i||"center",margin:[0,0,0,20]}),a&&h.push({text:`${a} ${g("DD/MM/YYYY")}`,fontSize:c||14,alignment:d||"center",margin:[0,0,0,20]}),h.push({image:m,width:350,alignment:"center"});const u=window.pdfMake.createPdf({content:h});if(this.props.device.touch&&!this.props.device.isWindowsTouchScreen)return u.open();u.download(`${l||"download"}.pdf`)},renderRadarChart(){const e=r(this.props.chartItems,(e=>e.itemLabel)),t=r(this.props.chartItems,(e=>e.score)),n=u(this.props.theme._componentItem._variables._componentItemBackgroundColor["@component-item-background-color"],this.props.theme._swatches);let o=u(s(this.props.component,"_chartLabelColor","transparent"),this.props.theme._swatches);o="transparent"===o?"#666666":o;let i=u(s(this.props.component,"_chartGridLinesColor","transparent"),this.props.theme._swatches);i="transparent"===i?"rgba(0,0,0,0.1)":i;const a={labels:e,datasets:[{data:t,backgroundColor:"rgba(0,0,0,0.3)",borderColor:n,borderWidth:4,scaleSteps:1,scaleStartValue:0,pointRadius:6,pointBorderWidth:3,pointBackgroundColor:n}]},c={scale:{ticks:{beginAtZero:!0,stepSize:1,fontColor:o},pointLabels:{fontSize:11,fontColor:o},gridLines:{color:i},angleLines:{color:i}},maintainAspectRatio:!1,legend:{display:!1}};return s(this.props.component,"_useCustomMaxChartValue",!1)&&(c.scale.ticks.max=s(this.props.component,"_customMaxChartValueNumber",10)),d.createElement(d.Suspense,{fallback:d.createElement("div",null)},d.createElement(b,{className:`ev-chart-${this.props.component._id}`,data:a,options:c,pointStyle:"circle"}))},renderConfidenceSliderItemCount(e){const t=i(e._confidenceSliders,(e=>!!this.props.confidenceSliders[e]));return r(t,(e=>{const t=this.props.confidenceSliders[e]._isComplete;return d.createElement("div",{key:e,className:p("ev-confidence-chart-count-chart-tag-chart-item",{"ev-is-complete":t})})}))},renderChartItems(){const{component:e}=this.props,t=e.displayTitle?this.context+1:this.context;return r(e._chartItems,(e=>d.createElement("div",{key:e._id,className:"ev-confidence-chart-count-chart-tag"},d.createElement("div",{className:"ev-confidence-chart-count-chart-tag-inner"},d.createElement(m,{element:`h${t}`,className:"ev-confidence-chart-count-chart-tag-name",html:e.itemLabel}),d.createElement("div",{className:"ev-confidence-chart-count-chart-tag-chart"},this.renderConfidenceSliderItemCount(e))))))},renderBreakDown(){if(!this.props.component._shouldHideBreakdown)return d.createElement("div",{className:"ev-confidence-chart-overview-container-breakdown"},this.renderChartItems())},renderDownloadButton(){const{_canDownload:e,downloadButtonText:t}=this.props.component;if(e)return d.createElement("button",{className:"ev-button",onClick:this.onDownloadClicked},t||"Download")},render(){const{props:e}=this;return d.createElement(w,{component:e.component,styles:e.styles,isVisibilitySensorActive:v(e,"_isComplete"),onVisibilityChange:this.onVisibilityChange},d.createElement("div",{className:h(e.component)},d.createElement("div",{className:p("ev-confidence-chart-overview-container-content",e.component._shouldHideBreakdown&&`ev-is-chart-${s(e.component,"_chartAlignment","left")}`)},d.createElement("div",{className:"ev-confidence-chart-overview-container-radar"},this.renderRadarChart()),this.renderBreakDown()),this.renderDownloadButton()))}});y.contextType=_,e.exports=l((({device:e})=>({device:e})),{loadPdfMake:C})(y)},29936:(e,t,n)=>{"use strict";const{registerComponent:o}=n(59671);o("confidenceChart",{component:n(43648),mapStateToProps:n(78919)})},78919:(e,t,n)=>{"use strict";const o=n(37213),r=n(65657),s=n(97987);e.exports=(e,{_useHighestValue:t,_chartItems:n})=>{const i={};return{chartItems:o(n,(n=>{let a=0,c=0;const d=[];o(n._confidenceSliders,(n=>{const o=s(n,e);if(o){if(t){const e=o._isComplete?o._selectedAnswer:0;d.push(e)}else o._isComplete&&(a+=o._selectedAnswer,c+=1);i[n]=o}}));let l=0;return t?l=r(d):a&&(l=Math.round(a/c)),{...n,score:l}})),confidenceSliders:i}}},8594:(e,t,n)=>{"use strict";const{format:o}=n(64213);e.exports=function(e="DD/MM/YYYY",t=new Date){return"string"==typeof t&&(t=new Date(t)),o(t,(e=>e.replace(/DD/g,"dd").replace(/YYYY/g,"yyyy"))(e))}},88153:e=>{"use strict";e.exports=(e,t="_hasBeenViewed")=>{const{component:n,isPageReady:o}=e;return!0===o&&!0===n._isReady&&!0!==n[t]}},67209:(e,t,n)=>{"use strict";const o=n(95685);e.exports=e=>o(`ev-${e._component}-widget ev-component-widget ev-clearfix`,{"ev-disabled":!e._isEnabled,"ev-complete ev-show-user-answer":e._isComplete&&!e._isEnabled,"ev-correct":e._isCorrect&&!e._isEnabled,"ev-submitted":e._isSubmitted})},17290:e=>{"use strict";e.exports=function(e,t,n,o,r){o&&o.props&&o.props.component?(t.top&&(o.isInviewTop=!0),t.bottom&&(o.isInviewBottom=!0),o.isInviewTop&&o.isInviewBottom&&r&&r(o.props.component._id)):console.error("No component reference passed to helpers/visibilityChangeHandler")}},60833:(e,t,n)=>{var o=n(22945);e.exports=function(e,t,n){for(var r=-1,s=e.length;++r<s;){var i=e[r],a=t(i);if(null!=a&&(void 0===c?a==a&&!o(a):n(a,c)))var c=a,d=i}return d}},49238:e=>{e.exports=function(e,t){return e>t}},65657:(e,t,n)=>{var o=n(60833),r=n(49238),s=n(15362);e.exports=function(e){return e&&e.length?o(e,s,r):void 0}}}]);