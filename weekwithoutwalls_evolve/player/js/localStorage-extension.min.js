"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6347],{22490:(e,a)=>{a.BOOKMARKING_COMPONENT_COMPLETED="BOOKMARKING_COMPONENT_COMPLETED",a.BOOKMARKING_NAVIGATE_TO_COMPONENT="BOOKMARKING_NAVIGATE_TO_COMPONENT",a.BOOKMARKING_CANCEL_CONTINUE="BOOKMARKING_CANCEL_CONTINUE",a.bookmarkingComponentCompleted=e=>({type:a.BOOKMARKING_COMPONENT_COMPLETED,payload:e})},14884:(e,a)=>{a.LOCALSTORAGE_LOAD_SESSION="LOCALSTORAGE_LOAD_SESSION",a.LOCALSTORAGE_SAVE_SESSION="LOCALSTORAGE_SAVE_SESSION",a.LOCALSTORAGE_CLEAR_SESSION="LOCALSTORAGE_CLEAR_SESSION",a.LOCALSTORAGE_SESSION_CHANGE="LOCALSTORAGE_SESSION_CHANGE",a.localStorageLoadSession=()=>({type:a.LOCALSTORAGE_LOAD_SESSION}),a.localStorageSaveSession=e=>({type:a.LOCALSTORAGE_SAVE_SESSION,payload:e}),a.localStorageClearSession=()=>({type:a.LOCALSTORAGE_CLEAR_SESSION}),a.localStorageSessionChange=e=>({type:a.LOCALSTORAGE_SESSION_CHANGE,payload:e})},49122:(e,a,o)=>{const t=o(63269),S=o(56786),{Observable:r}=o(49923),{DATA_READY:l,REFETCH_COURSE_DATA:n,setAppReadyState:c,resetCourse:s}=o(81661),{COMPONENT_COMPLETED:E,COMPONENT_TRACKABLE_CHANGE:i}=o(26759),{LOGIC_STATE_CHANGE:O}=o(14330),{getTracking:p,setTracking:_,restoreComponentAttributes:A}=o(82961),{BOOKMARKING_CANCEL_CONTINUE:g}=o(22490),{COURSE_ASSESSMENT_COMPONENTS_RESET:C}=o(74386),{LOCALSTORAGE_LOAD_SESSION:L,LOCALSTORAGE_SAVE_SESSION:N,LOCALSTORAGE_CLEAR_SESSION:T,localStorageLoadSession:R,localStorageSaveSession:u,localStorageClearSession:d,localStorageSessionChange:y}=o(14884);a.localStorageSetupEpic=(e,a)=>e.filter((e=>{if(e.type!==l)return!1;const{app:o,course:t}=a.getState();return!o.isLivePreview&&t._localStorage?._isEnabled})).mergeMap((()=>r.concat(r.of(c("localStorage",!1)),r.of(R()),r.of(c("localStorage",!0))))),a.localStorageLoadSessionEpic=(e,a)=>e.ofType(L).mergeMap((()=>{const{course:e,scorm:o,components:l}=a.getState(),n=o?._isEnabled;let c;try{c=localStorage.getItem(e._id)}catch(e){return console.warn("Localstorage not available for saving learning componentData",e),r.empty()}if(c){if(c=JSON.parse(c),c.useAdvancedTracking)return _(c,!0),r.of(y(c));const e=function(e,a,o){return t(e).keys().map((t=>{const r=e[t],l=S(a.components,{_id:t});return o&&r._isComplete||!o?{...r,...l}:r})).keyBy("_id").value()}(l,c,n);return A(e),r.of(y(c))}return r.empty()})).catch((e=>(console.warn("LocalStorage load error",e),r.of({type:"LOCALSTORAGE_ERROR",payload:e})))),a.localStorageSaveSessionEpic=(e,a)=>e.ofType(N).map((e=>{const o=function(e,a){const{course:o}=e;return p((e=>{const t={...e,useAdvancedTracking:!0,lastCompletedComponentId:a||""};try{localStorage.setItem(o._id,JSON.stringify(t))}catch(e){console.warn("Localstorage not available for saving learning componentData",e)}return t}))}(a.getState(),e.payload);return y(o)})).catch((e=>r.of({type:"LOCALSTORAGE_ERROR",payload:e}))),a.localStorageClearSessionEpic=(e,a)=>e.ofType(T).map((()=>{const{course:e}=a.getState();return function(e){try{null!==localStorage.getItem(e)&&localStorage.removeItem(e)}catch(e){console.warn("Localstorage not available for saving learning data",e)}}(e._id),y({})})).catch((e=>r.of({type:"LOCALSTORAGE_ERROR",payload:e}))),a.localStorageHandleResetsEpic=(e,a)=>e.filter((e=>{if(![C,n].includes(e.type))return!1;const{app:o,course:t}=a.getState();return!o.isLivePreview&&t._localStorage?._isEnabled})).map((()=>d())),a.localStorageComponentCompleteEpic=(e,a)=>e.filter((e=>{if(![E,i].includes(e.type))return!1;const{app:o,_localStorage:t}=a.getState();return!o.isLivePreview&&t?._isEnabled})).map((e=>u(e.payload.componentId))),a.localStorageLogicStateChangeEpic=(e,a)=>e.filter((e=>{if(e.type!==O)return!1;const{app:o,_localStorage:t}=a.getState();return!o.isLivePreview&&t?._isEnabled})).map((()=>u())),a.localStorageBookmarkingCancelEpic=(e,a)=>e.filter((e=>{if(e.type!==g)return!1;const{app:o,scorm:t,_localStorage:S}=a.getState();return!t?._isEnabled&&!o.isLivePreview&&S?._isEnabled&&S?._shouldResetUsingBookMarking})).map((()=>s()))},98581:(e,a,o)=>{const{registerReducer:t,registerEpics:S}=o(59671),r=o(48418),{localStorageSetupEpic:l,localStorageLoadSessionEpic:n,localStorageSaveSessionEpic:c,localStorageClearSessionEpic:s,localStorageComponentCompleteEpic:E,localStorageBookmarkingCancelEpic:i,localStorageHandleResetsEpic:O,localStorageLogicStateChangeEpic:p}=o(49122);t("_localStorage",r),S(l,n,c,s,E,i,O,p)},48418:(e,a,o)=>{const{SETUP_DATA:t}=o(81661),S={_isEnabled:!1,session:{}},{LOCALSTORAGE_SESSION_CHANGE:r}=o(14884);e.exports=(e=S,a)=>{if(a.type===t){const{_localStorage:o}=a.payload.course;return o?._isEnabled?{...e,...o}:S}return e._isEnabled?a.type===r?{...e,session:a.payload}:e:S}}}]);